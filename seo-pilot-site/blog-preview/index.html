<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5ZTWCD2L');</script>
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow" />
  <title>Blog Preview | TheSEOPilot</title>
  <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />
  <script defer src="/script.js"></script>
  <!-- Load optional config to override Preview API base (see docs/PREVIEW-SETUP.md) -->
  <script src="/blog-preview/config.js"></script>
</head>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5ZTWCD2L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <header class="site-header">
    <div class="nav-container">
      <a href="/" class="nav-brand link-wrapper">
        <div class="nav-logo-circle-frame">
          <img src="/assets/img/logo-footer.webp" loading="lazy" alt="TheSEOPilot Logo" class="nav-logo" />
        </div>
        <div class="nav-logo">The<span class="logo-accent">SEO</span>Pilot</div>
      </a>
      <nav class="desktop-nav">
        <a href="/#services">Services</a>
        <a href="/#workflow">Process</a>
        <a href="/#about">About</a>
        <a href="/resources/">Resources</a>
        <a href="/#contact" class="nav-cta">Get Started</a>
      </nav>
      <div class="hamburger" onclick="toggleMenu()">☰</div>
    </div>
    <div class="mobile-nav" id="mobileNav">
      <a href="/#services">Services</a>
      <a href="/#workflow">Process</a>
      <a href="/#about">About</a>
      <a href="/resources/">Resources</a>
      <a href="/#contact">Get Started</a>
    </div>
  </header>

  <main class="case-study-page">
    <nav class="breadcrumb" aria-label="Breadcrumb">
      <a href="/">Home</a> / <a href="/resources/">Resources</a> / <a href="/resources/blog/">Blog</a> / Preview
    </nav>
    <div class="container" style="padding-top: 1rem;">
      <p style="margin-bottom: 1rem; color: var(--muted); font-size: 0.95rem;">
        <strong>Preview mode</strong> — Draft content from Contentful. This page is not indexed.
      </p>
      <div id="previewRoot">
        <p id="previewStatus" style="text-align: center; color: var(--muted);">Loading…</p>
        <div id="previewContent" style="display: none;"></div>
      </div>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container footer-content">
      <div class="footer-brand">
        <div class="logo-circle-frame">
          <img src="/assets/img/logo-footer.webp" loading="lazy" alt="TheSEOPilot Logo" class="footer-logo" />
        </div>
        <div>
          <div class="nav-logo">The<span class="logo-accent">SEO</span>Pilot</div>
          <p>Your SEO Growth Partner.</p>
        </div>
      </div>
      <div class="footer-links">
        <h5>Legal</h5>
        <ul>
          <li><a href="/privacy/">Privacy</a></li>
          <li><a href="/terms/">Terms</a></li>
        </ul>
      </div>
    </div>
  </footer>
  <div class="copyright">
    <p>&copy; 2025 TheSEOPilot. All rights reserved.</p>
  </div>

  <script>
    (function () {
      var apiBase = window.PREVIEW_API_BASE || '';
      var params = new URLSearchParams(window.location.search);
      var slug = (params.get('slug') || '').trim();
      var id = (params.get('id') || '').trim();

      var statusEl = document.getElementById('previewStatus');
      var contentEl = document.getElementById('previewContent');

      function show(msg, isError) {
        statusEl.style.display = 'block';
        statusEl.textContent = msg;
        statusEl.style.color = isError ? '#b91c1c' : 'var(--muted)';
        contentEl.style.display = 'none';
      }

      function render(post) {
        statusEl.style.display = 'none';
        contentEl.style.display = 'block';
        contentEl.innerHTML =
          '<h1 style="margin-bottom: 1rem;">' + escapeHtml(post.title) + '</h1>' +
          '<div class="legal-page">' + (post.body || '') + '</div>';
        document.title = (post.seoTitle || post.title) + ' — Preview | TheSEOPilot';
        var desc = document.querySelector('meta[name="description"]');
        if (!desc) {
          desc = document.createElement('meta');
          desc.name = 'description';
          document.head.appendChild(desc);
        }
        desc.content = (post.seoDescription || post.excerpt || '').slice(0, 160);
      }

      function escapeHtml(s) {
        if (s == null) return '';
        var d = document.createElement('div');
        d.textContent = s;
        return d.innerHTML;
      }

      if (!slug && !id) {
        show('Add ?slug=your-post-slug or ?id=entry-id to the URL. In Contentful, use Preview URL: https://www.theseopilot.pro/blog-preview?slug={{entry.fields.slug}}', true);
        return;
      }

      if (!apiBase) {
        show('Preview API base URL not set. Create /blog-preview/config.js with window.PREVIEW_API_BASE = "https://your-preview-api.onrender.com"; See docs/PREVIEW-SETUP.md.', true);
        return;
      }

      var q = id ? ('id=' + encodeURIComponent(id)) : ('slug=' + encodeURIComponent(slug));
      var url = apiBase.replace(/\/$/, '') + '/api/preview?' + q;

      fetch(url)
        .then(function (r) { return r.json(); })
        .then(function (data) {
          if (data.ok && data.post) {
            render(data.post);
          } else {
            show(data.error || 'Entry not found', true);
          }
        })
        .catch(function (err) {
          show('Preview fetch failed: ' + (err.message || 'Network error'), true);
        });
    })();
  </script>
</body>

</html>
